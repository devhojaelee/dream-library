# 📚 Dream Library - 메타데이터 보완 가이드

## 개요

Z-Library에서 다운로드한 책 중 표지 이미지나 설명이 없는 경우, Google Books API를 통해 자동으로 메타데이터를 보완하는 스크립트입니다.

## 기능

- ✅ 책 표지 이미지 자동 다운로드
- ✅ 책 설명(description) 자동 추가
- ✅ 저자 정보 자동 보완
- ✅ 출판년도 자동 추가
- ✅ 이미 완전한 메타데이터가 있는 책은 스킵
- ✅ API 호출 제한 고려 (1초 간격)

## 사용 방법

### 1. 가상환경 활성화

```bash
source venv/bin/activate
```

### 2. 스크립트 실행

```bash
python3 enrich_metadata.py
```

### 3. 결과 확인

스크립트는 다음과 같이 작동합니다:

```
============================================================
📚 Dream Library 메타데이터 보완 시작
============================================================

총 10개의 책을 처리합니다.

[1/10] 🔍 책제목... 검색 중...
  ✅ 설명 추가: ...
  ✅ 표지 다운로드: ...
  ✅ 저자 추가: ...
  ✅ 출판년도 추가: ...
  💾 메타데이터 저장 완료

============================================================
📊 처리 결과
============================================================
✅ 업데이트됨: 10개
⏭️  스킵됨: 0개
❌ 실패: 0개
============================================================
```

## 파일 구조

```
books/
├── *.epub                    # EPUB 파일들
├── metadata/
│   └── {책제목}.json        # 메타데이터 JSON 파일
└── covers/
    └── {책제목}.jpg         # 표지 이미지 파일
```

### 메타데이터 JSON 형식

```json
{
  "description": "책 설명",
  "cover": "책제목.jpg",
  "author": "저자명",
  "year": "2024"
}
```

## 동작 원리

1. **EPUB 파일 검색**: `books/` 디렉토리에서 모든 `.epub` 파일을 찾습니다
2. **메타데이터 확인**: 각 책의 메타데이터 파일(`metadata/{책제목}.json`)을 확인
3. **누락 항목 확인**: `cover`와 `description`이 모두 있으면 스킵
4. **Google Books API 검색**: 책 제목으로 Google Books API 검색
5. **정보 다운로드**:
   - 표지 이미지를 `covers/` 디렉토리에 다운로드
   - 설명, 저자, 출판년도를 메타데이터에 추가
6. **메타데이터 저장**: 업데이트된 정보를 JSON 파일에 저장

## 주의사항

- **API 제한**: Google Books API는 무료이지만 호출 제한이 있을 수 있습니다
- **검색 정확도**: 책 제목으로 검색하므로 100% 정확하지 않을 수 있습니다
- **한국어 우선**: `langRestrict: 'ko'` 설정으로 한국어 책 정보를 우선 검색합니다
- **네트워크 필요**: 인터넷 연결이 필요합니다

## 트러블슈팅

### 표지 다운로드 실패

- Google Books에서 제공하는 표지 이미지가 없는 경우 발생
- 수동으로 표지를 `covers/` 디렉토리에 추가하고 메타데이터 JSON에서 `"cover": "파일명.jpg"` 설정

### 검색 결과 없음

- 책 제목이 정확하지 않거나 Google Books에 등록되지 않은 책
- 필요시 수동으로 메타데이터 JSON 파일을 수정

### SSL 경고

```
NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+
```

- 무시해도 됩니다. 기능에는 영향이 없습니다

## Docker 환경에서 사용

Docker 컨테이너 내부에서 실행:

```bash
# Docker 컨테이너 접속
docker exec -it dream-library-web sh

# 스크립트 실행
cd /app
python3 enrich_metadata.py
```

## 예제

### 실행 전 메타데이터

```json
{}
```

### 실행 후 메타데이터

```json
{
  "description": "머리가 복잡해질 때마다 다시 읽는 책! 독자들의 신뢰와 사랑을 받아온...",
  "cover": "우연의 설계.jpg",
  "author": "하지현",
  "year": "2023"
}
```

## 기여

버그 리포트나 개선 제안은 GitHub Issues로 제출해주세요.

## 라이선스

MIT License
